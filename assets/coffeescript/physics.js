// Generated by CoffeeScript 1.3.3
/*global Box2D:false, $:false
*/(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h;a=Box2D.Common.Math.b2Vec2;t=Box2D.Dynamics.b2BodyDef;e=Box2D.Dynamics.b2Body;s=Box2D.Dynamics.b2FixtureDef;i=Box2D.Dynamics.b2Fixture;f=Box2D.Dynamics.b2World;o=Box2D.Collision.Shapes.b2MassData;u=Box2D.Collision.Shapes.b2PolygonShape;n=Box2D.Collision.Shapes.b2CircleShape;r=Box2D.Dynamics.b2DebugDraw;l=$("#gameCanvas")[0];c=$("#debugCanvas")[0];h=[];window.game={_:{state_changed:function(e){if(e==="BUILD")return window.game.reset()},update:function(){var e;if((e=window.viewModel.state())==="PAUSE"||e==="BUILD"){window.game._.world.DrawDebugData();return}window.game._.world.Step(1/60,10,10);window.game._.world.DrawDebugData();return window.game._.world.ClearForces()},entities:[]},initialise:function(){var e;window.game._.world=new f(new a(0,10),!0);e=new r;e.SetSprite(c.getContext("2d"));e.SetDrawScale(30);e.SetFillAlpha(.3);e.SetLineThickness(1);e.SetFlags(r.e_shapeBit||r.e_jointBit);return window.game._.world.SetDebugDraw(e)},create_dynamic_entity:function(r,i){var o,u,a;o=new t;o.type=e.b2_dynamicBody;o.position.Set(r,i);a=new s;a.density=10;a.friction=.5;a.restitution=.2;a.shape=new n(1);u=window.game._.world.CreateBody(o).CreateFixture(a);return window.game._.entities.push(u)},load_state:function(e,t){if(t)return window.game.default_state=e},get_state:function(){},play:function(){return window.game.build_state=window.game.get_state()},reset:function(){var e,t,n,r;r=window.game._.entities;for(t=0,n=r.length;t<n;t++){e=r[t];window.game._.world.DestroyBody(e.GetBody())}window.game._.entities=[];return window.game.create_dynamic_entity(5,5)},reset_hard:function(){}};window.game.initialise();window.setInterval(window.game._.update,1e3/60);window.viewModel.state.subscribe(window.game._.state_changed)}).call(this);